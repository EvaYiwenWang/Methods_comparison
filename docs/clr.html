<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 4 CLR_LOGISTIC_LASSO | Methods Comparison</title>
  <meta name="description" content="Methods comparison">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 4 CLR_LOGISTIC_LASSO | Methods Comparison" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Methods comparison" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 CLR_LOGISTIC_LASSO | Methods Comparison" />
  
  <meta name="twitter:description" content="Methods comparison" />
  



<meta name="date" content="2019-02-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="coda.html">
<link rel="next" href="selbal.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Methods comparison</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#packages-installation-and-loading"><i class="fa fa-check"></i><b>1.1</b> Packages installation and loading</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#simulations"><i class="fa fa-check"></i><b>1.2</b> Simulations</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#example-datasets"><i class="fa fa-check"></i><b>1.3</b> Example datasets</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#crohn-disease-data"><i class="fa fa-check"></i><b>1.3.1</b> Crohn disease data</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#beme-day1-data"><i class="fa fa-check"></i><b>1.3.2</b> BEME day1 data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="implem.html"><a href="implem.html"><i class="fa fa-check"></i><b>2</b> Methods implementation</a><ul>
<li class="chapter" data-level="2.1" data-path="implem.html"><a href="implem.html#logistic-lasso"><i class="fa fa-check"></i><b>2.1</b> LOGISTIC LASSO</a></li>
<li class="chapter" data-level="2.2" data-path="implem.html"><a href="implem.html#logistic-elastic-net"><i class="fa fa-check"></i><b>2.2</b> LOGISTIC ELASTIC NET</a></li>
<li class="chapter" data-level="2.3" data-path="implem.html"><a href="implem.html#ranglambda"><i class="fa fa-check"></i><b>2.3</b> rangLambda</a></li>
<li class="chapter" data-level="2.4" data-path="implem.html"><a href="implem.html#soft-thresholding"><i class="fa fa-check"></i><b>2.4</b> Soft thresholding</a></li>
<li class="chapter" data-level="2.5" data-path="implem.html"><a href="implem.html#other-functions"><i class="fa fa-check"></i><b>2.5</b> Other functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="coda.html"><a href="coda.html"><i class="fa fa-check"></i><b>3</b> CODA_LOGISTIC_LASSO</a><ul>
<li class="chapter" data-level="3.1" data-path="coda.html"><a href="coda.html#crohn-disease-data-1"><i class="fa fa-check"></i><b>3.1</b> Crohn disease data</a></li>
<li class="chapter" data-level="3.2" data-path="coda.html"><a href="coda.html#beme-day1-data-1"><i class="fa fa-check"></i><b>3.2</b> BEME day1 data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clr.html"><a href="clr.html"><i class="fa fa-check"></i><b>4</b> CLR_LOGISTIC_LASSO</a><ul>
<li class="chapter" data-level="4.1" data-path="clr.html"><a href="clr.html#crohn-disease-data-2"><i class="fa fa-check"></i><b>4.1</b> Crohn disease data</a></li>
<li class="chapter" data-level="4.2" data-path="clr.html"><a href="clr.html#beme-day1-data-2"><i class="fa fa-check"></i><b>4.2</b> BEME day1 data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="selbal.html"><a href="selbal.html"><i class="fa fa-check"></i><b>5</b> Selbal: selection of balances</a><ul>
<li class="chapter" data-level="5.1" data-path="selbal.html"><a href="selbal.html#crohn-disease-data-3"><i class="fa fa-check"></i><b>5.1</b> Crohn disease data</a></li>
<li class="chapter" data-level="5.2" data-path="selbal.html"><a href="selbal.html#beme-day1-data-3"><i class="fa fa-check"></i><b>5.2</b> BEME day1 data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="comparison.html"><a href="comparison.html"><i class="fa fa-check"></i><b>6</b> Concordance of variables selected by the three methods</a><ul>
<li class="chapter" data-level="6.1" data-path="comparison.html"><a href="comparison.html#crohn-disease-data-4"><i class="fa fa-check"></i><b>6.1</b> Crohn disease data</a></li>
<li class="chapter" data-level="6.2" data-path="comparison.html"><a href="comparison.html#beme-day1-data-4"><i class="fa fa-check"></i><b>6.2</b> BEME day1 data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/EvaYiwenWang/vignette" target="blank">Source codes on github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Methods Comparison</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clr" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> CLR_LOGISTIC_LASSO</h1>
<div id="crohn-disease-data-2" class="section level2">
<h2><span class="header-section-number">4.1</span> Crohn disease data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y&lt;-y_Crohn_numeric </code></pre></div>
<p><em>glmnet()</em> requires y to be numeric.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">as.matrix</span>(x_Crohn) 

<span class="co"># CLR transformation Z=log(x)</span>
z&lt;-<span class="kw">log</span>(x)
clrx&lt;-<span class="st"> </span><span class="kw">apply</span>(z,<span class="dv">2</span>,<span class="cf">function</span> (x) x<span class="op">-</span><span class="kw">rowMeans</span>(z))
<span class="co">#rowMeans(clrx)  </span>

clrlasso &lt;-<span class="st"> </span><span class="kw">glmnet</span>(clrx, y, <span class="dt">standardize=</span><span class="ot">FALSE</span> , <span class="dt">alpha=</span><span class="dv">1</span>,<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="dt">lambda=</span><span class="kw">seq</span>(<span class="fl">0.015</span>,<span class="dv">2</span>,<span class="fl">0.01</span>)) 
<span class="kw">plot</span>(clrlasso)</code></pre></div>
<p><img src="Methods_comparison_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(clrlasso)</code></pre></div>
<pre><code>## 
## Call:  glmnet(x = clrx, y = y, family = &quot;binomial&quot;, alpha = 1, lambda = seq(0.015,      2, 0.01), standardize = FALSE) 
## 
##        Df      %Dev Lambda
##   [1,]  0 1.769e-15  1.995
##   [2,]  0 1.769e-15  1.985
##   [3,]  0 1.769e-15  1.975
##   [4,]  0 1.769e-15  1.965
##   [5,]  0 1.769e-15  1.955
##   [6,]  0 1.769e-15  1.945
##   [7,]  0 1.769e-15  1.935
##   [8,]  0 1.769e-15  1.925
##   [9,]  0 7.783e-15  1.915
##  [10,]  0 1.769e-15  1.905
##  [11,]  0 1.769e-15  1.895
##  [12,]  0 1.769e-15  1.885
##  [13,]  0 1.769e-15  1.875
##  [14,]  0 1.769e-15  1.865
##  [15,]  0 1.769e-15  1.855
##  [16,]  0 1.769e-15  1.845
##  [17,]  0 1.769e-15  1.835
##  [18,]  0 1.769e-15  1.825
##  [19,]  0 1.769e-15  1.815
##  [20,]  0 1.769e-15  1.805
##  [21,]  0 7.783e-15  1.795
##  [22,]  0 1.769e-15  1.785
##  [23,]  0 1.769e-15  1.775
##  [24,]  0 1.769e-15  1.765
##  [25,]  0 1.769e-15  1.755
##  [26,]  0 1.769e-15  1.745
##  [27,]  0 1.769e-15  1.735
##  [28,]  0 1.769e-15  1.725
##  [29,]  0 1.769e-15  1.715
##  [30,]  0 1.769e-15  1.705
##  [31,]  0 1.769e-15  1.695
##  [32,]  0 1.769e-15  1.685
##  [33,]  0 7.783e-15  1.675
##  [34,]  0 1.769e-15  1.665
##  [35,]  0 1.769e-15  1.655
##  [36,]  0 1.769e-15  1.645
##  [37,]  0 1.769e-15  1.635
##  [38,]  0 1.769e-15  1.625
##  [39,]  0 1.769e-15  1.615
##  [40,]  0 1.769e-15  1.605
##  [41,]  0 1.769e-15  1.595
##  [42,]  0 1.769e-15  1.585
##  [43,]  0 1.769e-15  1.575
##  [44,]  0 1.769e-15  1.565
##  [45,]  0 7.783e-15  1.555
##  [46,]  0 1.769e-15  1.545
##  [47,]  0 1.769e-15  1.535
##  [48,]  0 1.769e-15  1.525
##  [49,]  0 1.769e-15  1.515
##  [50,]  0 1.769e-15  1.505
##  [51,]  0 1.769e-15  1.495
##  [52,]  0 1.769e-15  1.485
##  [53,]  0 1.769e-15  1.475
##  [54,]  0 1.769e-15  1.465
##  [55,]  0 1.769e-15  1.455
##  [56,]  0 1.769e-15  1.445
##  [57,]  0 7.783e-15  1.435
##  [58,]  0 1.769e-15  1.425
##  [59,]  0 1.769e-15  1.415
##  [60,]  0 1.769e-15  1.405
##  [61,]  0 1.769e-15  1.395
##  [62,]  0 1.769e-15  1.385
##  [63,]  0 1.769e-15  1.375
##  [64,]  0 1.769e-15  1.365
##  [65,]  0 1.769e-15  1.355
##  [66,]  0 1.769e-15  1.345
##  [67,]  0 1.769e-15  1.335
##  [68,]  0 1.769e-15  1.325
##  [69,]  0 7.783e-15  1.315
##  [70,]  0 1.769e-15  1.305
##  [71,]  0 1.769e-15  1.295
##  [72,]  0 1.769e-15  1.285
##  [73,]  0 1.769e-15  1.275
##  [74,]  0 1.769e-15  1.265
##  [75,]  0 1.769e-15  1.255
##  [76,]  0 1.769e-15  1.245
##  [77,]  0 1.769e-15  1.235
##  [78,]  0 1.769e-15  1.225
##  [79,]  0 1.769e-15  1.215
##  [80,]  0 1.769e-15  1.205
##  [81,]  0 7.783e-15  1.195
##  [82,]  0 1.769e-15  1.185
##  [83,]  0 1.769e-15  1.175
##  [84,]  0 1.769e-15  1.165
##  [85,]  0 1.769e-15  1.155
##  [86,]  0 1.769e-15  1.145
##  [87,]  0 1.769e-15  1.135
##  [88,]  0 1.769e-15  1.125
##  [89,]  0 1.769e-15  1.115
##  [90,]  0 1.769e-15  1.105
##  [91,]  0 1.769e-15  1.095
##  [92,]  0 1.769e-15  1.085
##  [93,]  0 7.783e-15  1.075
##  [94,]  0 1.769e-15  1.065
##  [95,]  0 1.769e-15  1.055
##  [96,]  0 1.769e-15  1.045
##  [97,]  0 1.769e-15  1.035
##  [98,]  0 1.769e-15  1.025
##  [99,]  0 1.769e-15  1.015
## [100,]  0 1.769e-15  1.005
## [101,]  0 1.769e-15  0.995
## [102,]  0 1.769e-15  0.985
## [103,]  0 1.769e-15  0.975
## [104,]  0 1.769e-15  0.965
## [105,]  0 7.783e-15  0.955
## [106,]  0 1.769e-15  0.945
## [107,]  0 1.769e-15  0.935
## [108,]  0 1.769e-15  0.925
## [109,]  0 1.769e-15  0.915
## [110,]  0 1.769e-15  0.905
## [111,]  0 1.769e-15  0.895
## [112,]  0 1.769e-15  0.885
## [113,]  0 1.769e-15  0.875
## [114,]  0 1.769e-15  0.865
## [115,]  0 1.769e-15  0.855
## [116,]  0 1.769e-15  0.845
## [117,]  0 7.783e-15  0.835
## [118,]  0 1.769e-15  0.825
## [119,]  0 1.769e-15  0.815
## [120,]  0 1.769e-15  0.805
## [121,]  0 1.769e-15  0.795
## [122,]  0 1.769e-15  0.785
## [123,]  0 1.769e-15  0.775
## [124,]  0 1.769e-15  0.765
## [125,]  0 1.769e-15  0.755
## [126,]  0 1.769e-15  0.745
## [127,]  0 1.769e-15  0.735
## [128,]  0 1.769e-15  0.725
## [129,]  0 7.783e-15  0.715
## [130,]  0 1.769e-15  0.705
## [131,]  0 1.769e-15  0.695
## [132,]  0 1.769e-15  0.685
## [133,]  0 1.769e-15  0.675
## [134,]  0 1.769e-15  0.665
## [135,]  0 1.769e-15  0.655
## [136,]  0 1.769e-15  0.645
## [137,]  0 1.769e-15  0.635
## [138,]  0 1.769e-15  0.625
## [139,]  0 1.769e-15  0.615
## [140,]  0 1.769e-15  0.605
## [141,]  0 7.783e-15  0.595
## [142,]  0 1.769e-15  0.585
## [143,]  0 1.769e-15  0.575
## [144,]  0 1.769e-15  0.565
## [145,]  0 1.769e-15  0.555
## [146,]  0 1.769e-15  0.545
## [147,]  0 1.769e-15  0.535
## [148,]  0 1.769e-15  0.525
## [149,]  0 1.769e-15  0.515
## [150,]  0 1.769e-15  0.505
## [151,]  0 1.769e-15  0.495
## [152,]  0 1.769e-15  0.485
## [153,]  0 7.783e-15  0.475
## [154,]  0 1.769e-15  0.465
## [155,]  0 1.769e-15  0.455
## [156,]  0 1.769e-15  0.445
## [157,]  0 1.769e-15  0.435
## [158,]  0 1.769e-15  0.425
## [159,]  0 1.769e-15  0.415
## [160,]  0 1.769e-15  0.405
## [161,]  0 1.769e-15  0.395
## [162,]  0 1.769e-15  0.385
## [163,]  1 1.275e-03  0.375
## [164,]  1 7.497e-03  0.365
## [165,]  1 1.355e-02  0.355
## [166,]  1 1.944e-02  0.345
## [167,]  1 2.517e-02  0.335
## [168,]  1 3.074e-02  0.325
## [169,]  1 3.615e-02  0.315
## [170,]  1 4.141e-02  0.305
## [171,]  1 4.651e-02  0.295
## [172,]  1 5.146e-02  0.285
## [173,]  1 5.626e-02  0.275
## [174,]  1 6.091e-02  0.265
## [175,]  1 6.541e-02  0.255
## [176,]  1 6.976e-02  0.245
## [177,]  1 7.396e-02  0.235
## [178,]  1 7.802e-02  0.225
## [179,]  2 8.230e-02  0.215
## [180,]  2 8.806e-02  0.205
## [181,]  2 9.359e-02  0.195
## [182,]  2 9.891e-02  0.185
## [183,]  2 1.040e-01  0.175
## [184,]  2 1.089e-01  0.165
## [185,]  2 1.135e-01  0.155
## [186,]  3 1.181e-01  0.145
## [187,]  3 1.240e-01  0.135
## [188,]  5 1.319e-01  0.125
## [189,]  8 1.422e-01  0.115
## [190,] 10 1.557e-01  0.105
## [191,] 12 1.711e-01  0.095
## [192,] 12 1.860e-01  0.085
## [193,] 12 1.999e-01  0.075
## [194,] 12 2.125e-01  0.065
## [195,] 13 2.256e-01  0.055
## [196,] 20 2.457e-01  0.045
## [197,] 23 2.683e-01  0.035
## [198,] 27 2.910e-01  0.025
## [199,] 30 3.162e-01  0.015</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clrlasso_coef&lt;-<span class="kw">coef</span>(clrlasso,<span class="dt">s=</span><span class="fl">0.10</span>)
<span class="kw">sum</span>(<span class="kw">abs</span>(clrlasso_coef)<span class="op">&gt;</span><span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">selected_clrlasso&lt;-<span class="kw">which</span>(<span class="kw">as.numeric</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(clrlasso, <span class="dt">s=</span><span class="fl">0.1</span>)))<span class="op">&gt;</span><span class="dv">0</span>)[<span class="op">-</span><span class="dv">1</span>]; </code></pre></div>
<p>The indices of selected variables (abs(coef)&gt;0)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">selected_clrlasso&lt;-selected_clrlasso<span class="op">-</span><span class="dv">1</span>
taxa_id&lt;-<span class="kw">colnames</span>(x_Crohn)[selected_clrlasso]

<span class="kw">write.csv</span>(<span class="kw">data.frame</span>(selected_clrlasso,taxa_id),<span class="st">&quot;./Generated_datasets/results_clrlasso_Crohn12.csv&quot;</span>)</code></pre></div>
</div>
<div id="beme-day1-data-2" class="section level2">
<h2><span class="header-section-number">4.2</span> BEME day1 data</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="coda.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="selbal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Methods_comparison.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
