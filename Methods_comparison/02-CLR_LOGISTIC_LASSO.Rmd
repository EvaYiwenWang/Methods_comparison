# CLR_LOGISTIC_LASSO {#clr}

Then, we illustrate a combined method with centered logratio transformation (CLR) and lasso.

## CD data

```{r}
x <- as.matrix(x_Crohn)
y <- y_Crohn_numeric 
```

Here, y is numeric, because *glmnet()* requires y to be numeric.

```{r}
# CLR transformation Z=log(x)
z <- log(x)
clrx <- apply(z, 2, function(x) x-rowMeans(z))
# rowMeans(clrx)  
```

x (the matrix of microbiome abundances) is then CLR transformed. 

```{r, fig.pos = 'H'}
clrlasso <- glmnet(clrx, y, standardize = FALSE, alpha = 1,family = "binomial", 
                   lambda = seq(0.015, 2, 0.01)) 
plot(clrlasso)
#print(clrlasso)
clrlasso_coef <- coef(clrlasso, s = 0.10)
sum(abs(clrlasso_coef) > 0)
selected_clrlasso <- which(as.numeric(abs(coef(clrlasso, s = 0.1))) > 0)[-1]; 
```

We obtain the indices of selected variables (abs(coef) > 0) from lasso.

```{r}
selected_clrlasso <- selected_clrlasso - 1
taxa_id <- colnames(x_Crohn)[selected_clrlasso]

write.csv(data.frame(selected_clrlasso, taxa_id),
          "./Generated_datasets/results_clrlasso_Crohn12.csv")
```

The name of selected genera and their indices are also saved in a csv file.

## BEME day1 data

content need to be added.