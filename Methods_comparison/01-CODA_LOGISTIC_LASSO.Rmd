# CODA_LOGISTIC_LASSO {#coda}

First, we illustrate the method lasso with linear constraints. 

## CD data

```{r}
x <- x_Crohn 
```

x is the matrix of microbiome abundances, either absolute abundances (counts) or relative abundances (proportions). However, x should not be the matrix of log(counts) or log(proportions). The method itself performs the log-transformation of the abundances.

```{r}
y <- y_Crohn 
summary(y)
```

In the CD data, y is the binary outcome, can be numerical (values 0 and 1), factor (2 levels) or categorical (2 categories).

```{r}
dim(x)
```

The rows of x are individuals/samples, the columns are taxa.

To run the method, we need a value of $\lambda$.

```{r}
rangLambda(y, x,numVar = 12, lambdaIni = 0.15)
```

It provides a rang of $\lambda$ values corresponding to a given number of variables to be selected (numVar).      

The default initial $\lambda$ is lambdaIni=1.

```{r}
results_codalasso <- coda_logistic_lasso(y, x, lambda = 0.19)
```

$\lambda$ is the penalization parameter: the larger the value of $\lambda$, the fewer number of variables will be selected.

```{r}
results_codalasso
selected_codalasso <- results_codalasso[[4]][-1]

columns_selected_codalasso <- results_codalasso[[3]][-1]

write.csv(data.frame(columns_selected_codalasso,selected_codalasso),
          "./Generated_datasets/results_codalasso_Crohn12.csv")

```

We extract the name of selected genera and their column indices and then save them in a csv file.

## BEME day1 data

content need to be added.